# MediaMTX - Gateway Configuration
# Docs: https://github.com/bluenviron/mediamtx

###############################################
# General
logLevel: info
logDestinations: [stdout]

###############################################
# API
api: true
apiAddress: :9997

###############################################
# RTSP server (recebe streams das cÃ¢meras)
rtsp: true
rtspAddress: :8554
rtspTransports: [tcp, udp]

###############################################
# WebRTC (habilitado para testes locais)
webrtc: true
webrtcAddress: :8889

###############################################
# HLS (fallback para testes no browser)
hls: true
hlsAddress: :8888

###############################################
# Paths
# Credenciais das cameras e IP do servidor devem estar no .env
# Use variavel de ambiente SONOFF_RTSP_URL e RELAY_SERVER
paths:
  sonoff-sala:
    source: $SONOFF_RTSP_URL
    sourceOnDemand: false
    runOnReady: >
      ffmpeg -rtsp_transport tcp -i rtsp://localhost:8554/sonoff-sala
      -c copy -f rtsp -rtsp_transport tcp rtsp://$RELAY_SERVER:8554/sonoff-sala
    runOnReadyRestart: true

  all_others:
    # Aceita streams publicados dinamicamente (ex: ONVIF discovery)
